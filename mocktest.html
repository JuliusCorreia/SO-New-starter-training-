<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Aviation Security – Mock Tests</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-grad: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      --accent: #0ea5e9;
      --accent-strong: #0284c7;
      --accent-soft: rgba(14, 165, 233, 0.12);
      --border-subtle: rgba(148, 163, 184, 0.25);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --radius-lg: 22px;
      --radius-md: 12px;
      --shadow-soft: 0 22px 50px rgba(15, 23, 42, 0.9);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: var(--bg-grad);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .frame {
      width: 100%;
      max-width: 780px;
      border-radius: 28px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: radial-gradient(circle at top left, #020617 0, #020617 60%);
      box-shadow: var(--shadow-soft);
      padding: 18px 18px 20px;
      backdrop-filter: blur(22px);
    }

    .frame-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .title {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: -0.02em;
    }

    .subtitle {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 11px;
      color: var(--text-muted);
    }

    .row-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 10px;
      font-size: 12px;
      color: var(--text-muted);
    }

    select {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      padding: 6px 10px;
      font-size: 12px;
      background: rgba(15, 23, 42, 0.95);
      color: var(--text-main);
      outline: none;
    }

    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(14, 165, 233, 0.45);
    }

    .progress-shell {
      width: 110px;
      height: 6px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.5);
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent-strong));
      transition: width 0.2s ease-out;
    }

    .question-card {
      margin-top: 8px;
      border-radius: var(--radius-lg);
      padding: 16px 14px 14px;
      background: rgba(15, 23, 42, 0.98);
      border: 1px solid rgba(148, 163, 184, 0.5);
    }

    .question-text {
      font-size: 15px;
      font-weight: 500;
      margin-bottom: 8px;
    }

    .question-count {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .options {
      display: grid;
      gap: 6px;
      margin-top: 6px;
    }

    .option-btn {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      padding: 7px 10px;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.96);
      font-size: 13px;
      transition: background 0.15s, border-color 0.15s, transform 0.1s, color 0.15s;
    }

    .option-btn span.key {
      font-weight: 600;
      color: var(--text-muted);
    }

    .option-btn.selected {
      border-color: var(--accent);
      background: var(--accent-soft);
      transform: translateY(-1px);
    }

    .option-btn.correct {
      border-color: #22c55e;
      background: rgba(34, 197, 94, 0.1);
    }

    .option-btn.incorrect {
      border-color: #f97373;
      background: rgba(248, 113, 113, 0.1);
    }

    .bottom-row {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: var(--text-muted);
    }

    .btn {
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 12px;
      border: 1px solid transparent;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, transform 0.1s, color 0.15s;
    }

    .btn-primary {
      background: var(--accent);
      color: #020617;
      border-color: rgba(15, 23, 42, 0.2);
    }

    .btn-primary:hover {
      background: var(--accent-strong);
    }

    .btn-ghost {
      background: rgba(15, 23, 42, 0.96);
      border-color: rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
    }

    .btn-ghost:hover {
      background: rgba(15, 23, 42, 1);
      color: #e5e7eb;
    }

    .btn:active {
      transform: scale(0.97);
    }

    .result {
      font-size: 13px;
    }

    @media (max-width: 640px) {
      .frame {
        padding: 14px 12px 16px;
        border-radius: 22px;
      }
    }
  </style>
</head>
<body>
  <div class="frame">
    <div class="frame-header">
      <div>
        <div class="title">Mock Tests – Aviation Security</div>
        <div class="subtitle">Multiple‑choice questions by topic.</div>
      </div>
      <div id="topicBadge" class="badge">Topic: —</div>
    </div>

    <div class="row-top">
      <div>
        Topic:
        <select id="topicSelect"></select>
      </div>
      <div>
        Progress
        <div class="progress-shell">
          <div id="progressBar" class="progress-bar"></div>
        </div>
      </div>
    </div>

    <div class="question-card">
      <div class="question-count" id="qCount">Question 0 of 0</div>
      <div class="question-text" id="qText">Press “Start” to begin.</div>
      <div class="options" id="options"></div>
    </div>

    <div class="bottom-row">
      <div class="result" id="resultText"></div>
      <div>
        <button class="btn btn-ghost" id="restartBtn">Restart</button>
        <button class="btn btn-primary" id="nextBtn">Start</button>
      </div>
    </div>
  </div>

  <!-- shared data -->
  <script src="data.js"></script>

  <script>
    // expects `topics` and `questions` from data.js

    const topicSelect = document.getElementById("topicSelect");
    const topicBadge = document.getElementById("topicBadge");
    const progressBar = document.getElementById("progressBar");
    const qCountEl = document.getElementById("qCount");
    const qTextEl = document.getElementById("qText");
    const optionsEl = document.getElementById("options");
    const resultText = document.getElementById("resultText");
    const restartBtn = document.getElementById("restartBtn");
    const nextBtn = document.getElementById("nextBtn");

    let currentTopicId = null;
    let quizQuestions = [];
    let index = 0;
    let score = 0;
    let started = false;
    let selectedKey = null;

    function buildTopicSelect() {
      const ids = Array.from(new Set(questions.map(q => q.topicId)));
      topicSelect.innerHTML = "";
      ids.forEach(id => {
        const t = topics.find(tp => tp.id === id);
        const opt = document.createElement("option");
        opt.value = id;
        opt.textContent = t ? t.name : `Topic ${id}`;
        topicSelect.appendChild(opt);
      });
      if (ids.length) {
        currentTopicId = ids[0];
        topicSelect.value = String(currentTopicId);
        loadTopic(currentTopicId);
      }
    }

    function loadTopic(topicId) {
      quizQuestions = questions.filter(q => q.topicId === topicId);
      index = 0;
      score = 0;
      started = false;
      selectedKey = null;
      const t = topics.find(tp => tp.id === topicId);
      topicBadge.textContent = "Topic: " + (t ? t.name : topicId);
      progressBar.style.width = "0%";
      resultText.textContent = "";
      qCountEl.textContent = `Question 0 of ${quizQuestions.length}`;
      qTextEl.textContent = quizQuestions.length
        ? "Press “Start” to begin."
        : "No questions for this topic yet.";
      optionsEl.innerHTML = "";
      nextBtn.textContent = "Start";
    }

    function renderQuestion() {
      if (!quizQuestions.length) {
        qTextEl.textContent = "No questions for this topic yet.";
        optionsEl.innerHTML = "";
        return;
      }
      const q = quizQuestions[index];
      qCountEl.textContent = `Question ${index + 1} of ${quizQuestions.length}`;
      qTextEl.textContent = q.text;
      optionsEl.innerHTML = "";
      selectedKey = null;
      progressBar.style.width =
        ((index) / quizQuestions.length) * 100 + "%";

      Object.entries(q.options).forEach(([key, label]) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "option-btn";
        btn.innerHTML = `<span class="key">${key}</span><span>${label}</span>`;
        btn.addEventListener("click", () => {
          if (!started) return;
          selectedKey = key;
          Array.from(optionsEl.children).forEach(c =>
            c.classList.remove("selected", "correct", "incorrect")
          );
          btn.classList.add("selected");
        });
        optionsEl.appendChild(btn);
      });

      nextBtn.textContent = index === quizQuestions.length - 1 ? "Finish" : "Next";
    }

    topicSelect.addEventListener("change", () => {
      currentTopicId = Number(topicSelect.value);
      loadTopic(currentTopicId);
    });

    nextBtn.addEventListener("click", () => {
      if (!quizQuestions.length) return;

      if (!started) {
        started = true;
        score = 0;
        index = 0;
        resultText.textContent = "";
        renderQuestion();
        return;
      }

      const q = quizQuestions[index];
      if (!selectedKey) {
        resultText.style.color = "#f97373";
        resultText.textContent = "Select an option before continuing.";
        return;
      }

      const optionButtons = Array.from(optionsEl.children);
      optionButtons.forEach(btn => {
        const keySpan = btn.querySelector(".key");
        const key = keySpan.textContent.trim();
        if (key === q.correct) {
          btn.classList.add("correct");
        } else if (key === selectedKey) {
          btn.classList.add("incorrect");
        }
      });

      if (selectedKey === q.correct) score++;

      resultText.textContent = "";
      setTimeout(() => {
        if (index < quizQuestions.length - 1) {
          index++;
          renderQuestion();
        } else {
          // done
          progressBar.style.width = "100%";
          qTextEl.textContent = "Test complete.";
          optionsEl.innerHTML = "";
          resultText.style.color = "#4ade80";
          resultText.textContent = `Score: ${score} / ${quizQuestions.length}`;
          nextBtn.textContent = "Restart";
          started = false;
        }
      }, 400);
    });

    restartBtn.addEventListener("click", () => loadTopic(currentTopicId));

    function init() {
      buildTopicSelect();
    }

    init();
  </script>
</body>
</html>
